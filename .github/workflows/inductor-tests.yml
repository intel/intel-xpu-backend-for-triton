name: Pytorch inductor tests

on:
  workflow_dispatch:
    inputs:
      pytorch_ref:
        description: PyTorch ref, keep empty for default
        type: string
        default: ""
      suite:
        description: Space separated lists of test suites, all if empty
        type: string
        default: >-
          inductor/test_codegen_triton.py
          inductor/test_triton_extension_backend.py
          inductor/test_triton_heuristics.py
          inductor/test_triton_wrapper.py
          inductor/test_triton_kernels.py
      runner_label:
        description: Runner label, keep empty for default
        type: string
        default: ""
      pytorch_repo:
        description: PyTorch repo
        type: string
        default: "pytorch/pytorch"
      python_version:
        description: Python version
        type: string
        default: "3.9"

permissions: read-all

jobs:
  run_tests:
    name: Run inductor tests
    uses: ./.github/workflows/inductor-tests-reusable.yml
    with:
      pytorch_repo: ${{ inputs.pytorch_repo }}
      python_version: ${{ inputs.python_version }}
      runner_label: ${{ inputs.runner_label }}
      suite: ${{ inputs.suite }}
      pytorch_ref: ${{ inputs.pytorch_ref }}
